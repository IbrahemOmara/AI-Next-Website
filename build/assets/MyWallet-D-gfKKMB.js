import{u as Y,r as n,i as A,d as E,j as e,e as R,q as f,f as h,g as u,h as N}from"./index-rN5JyR99.js";function B(){const r=JSON.parse(localStorage.dataAuth),g=Y(),[y,c]=n.useState(""),[x,d]=n.useState({}),[l,P]=n.useState([]),[i,w]=n.useState([]),[k,T]=n.useState([]),[U,S]=n.useState([]);async function j(s){await h.get(`${u}/User/GetYourBalance?userId=${s}`).then(({data:a})=>{d(typeof a=="string"?{remain:0}:a)}).catch(a=>{d({remain:0}),N.warning("You dont have any balance")})}function I(s){h.post(`${u}/User/RequestToken`,s).then(({data:a})=>{typeof a=="string"?c(a):(j(r.customerAttributeId),c(a.token),o(s.userId),b())}).catch(a=>{c("You dont have balance"),N.error("You dont have balance")})}async function o(s){return h.get(`${u}/User/GetUserTokens?userId=${s}`)}const{data:t,isLoading:$,refetch:b}=A("getUserTokens",()=>o(r.customerAttributeId),{refetchOnMount:!1,refetchOnWindowFocus:!1,refetchInterval:!1}),M=()=>{let s=0;l==null||l.forEach(a=>{s+=a.value}),S(s)},q=()=>{let s=0;i==null||i.forEach(a=>{s+=a.value}),T(s)};let m=E({initialValues:{userId:"",tokenValue:""},onSubmit:s=>{s.userId=r.customerAttributeId,I(s)}}),p,v;const D=()=>{P(p),w(v),M(),q()};return n.useEffect(()=>{const s=r.customerAttributeId;j(s),o(s),b(),typeof(t==null?void 0:t.data)!="string"&&(p=t==null?void 0:t.data.filter(a=>a.isUsed),v=t==null?void 0:t.data.filter(a=>!a.isUsed),D())},[t]),n.useEffect(()=>{r.ns_balance||g("/dashboard-user")},[]),$?e.jsx(R,{}):e.jsx(e.Fragment,{children:e.jsx("section",{className:"my-wallet",id:"my-wallet",children:e.jsxs("div",{className:"container",children:[e.jsx("div",{className:"row",children:e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"point-remain bg-grdient p-3 rounded-3 d-flex justify-content-between align-align-items-center ",children:[e.jsx("p",{className:"fs-5 fw-bold m-0",children:"Point Remaining"}),e.jsxs("p",{className:"fs-5 fw-bold m-0",children:[x.remain?x.remain:"0 ",e.jsx("span",{children:" Point"})]})]})})}),e.jsxs("form",{onSubmit:m.handleSubmit,className:"mt-5",children:[e.jsxs("div",{className:"row align-items-center",children:[e.jsx("div",{className:"col-md-8",children:e.jsxs("div",{className:"point-request",children:[e.jsx("label",{htmlFor:"tokenValue",className:"form-label  my-fw-bold",children:"Piont Request"}),e.jsxs("select",{onChange:m.handleChange,name:"tokenValue",className:"form-select select-piont py-2","aria-label":"Default select example",id:"tokenValue",children:[e.jsx("option",{defaultValue:!0,children:"Select Piont"}),e.jsx("option",{value:"3",children:"3"}),e.jsx("option",{value:"30",children:"30"}),e.jsx("option",{value:"75",children:"75"}),e.jsx("option",{value:"100",children:"100"}),e.jsx("option",{value:"111",children:"111"}),e.jsx("option",{value:"135",children:"135"}),e.jsx("option",{value:"150",children:"150"}),e.jsx("option",{value:"180",children:"180"}),e.jsx("option",{value:"235",children:"235"}),e.jsx("option",{value:"250",children:"250"}),e.jsx("option",{value:"330",children:"330"}),e.jsx("option",{value:"350",children:"350"}),e.jsx("option",{value:"630",children:"630"}),e.jsx("option",{value:"930",children:"930"}),e.jsx("option",{value:"1230",children:"1230"})]})]})}),e.jsx("div",{className:"col-md-4 mt-4 pt-2 ",children:e.jsx("button",{type:"submit",className:"btn bg-grdient py-2 border-0",children:"Request Points"})})]}),e.jsx("div",{className:"row mt-3",children:e.jsxs("div",{className:"col-md-8",children:[e.jsx("h6",{className:"fw-bold fs-5 ",children:"Code"}),e.jsx("div",{className:"show-code border p-2 rounded-3 code  ",children:y})]})})]}),e.jsxs("div",{className:"show-tokens mt-5",children:[e.jsxs("ul",{className:"nav nav-tabs justify-content-between border-0",id:"myTab",role:"tablist",children:[e.jsx("li",{className:"nav-item ",role:"presentation",children:e.jsx("button",{className:"nav-link active paid-btn btn p-0 ",id:"unPaid-tab","data-bs-toggle":"tab","data-bs-target":"#unPaid-tab-pane",type:"button",role:"tab","aria-controls":"unPaid-tab-pane","aria-selected":"true",children:"Un Paid"})}),e.jsx("li",{className:"nav-item",role:"presentation",children:e.jsx("button",{className:"nav-link btn p-0 paid-btn ",id:"paid-tab","data-bs-toggle":"tab","data-bs-target":"#paid-tab-pane",type:"button",role:"tab","aria-controls":"paid-tab-pane","aria-selected":"false",children:"Paid"})})]}),e.jsxs("div",{className:"tab-content mt-4",id:"myTabContent",children:[e.jsxs("div",{className:"tab-pane fade show active",id:"unPaid-tab-pane",role:"tabpanel","aria-labelledby":"unPaid-tab",tabIndex:0,children:[e.jsxs("h6",{className:"my-fw-bold ",children:["Total Price : ",k||0]}),e.jsx("div",{className:"table-responsive show-history-piont rounded-3 ",children:e.jsxs("table",{className:"table  text-center fw-bold",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:"#"}),e.jsx("th",{scope:"col",children:"Token"}),e.jsx("th",{scope:"col",children:"Price"}),e.jsx("th",{scope:"col",children:"Date"})]})}),e.jsx("tbody",{children:t!="You dont have any tokens"?i==null?void 0:i.slice().reverse().map((s,a=0)=>e.jsxs("tr",{className:`${s.isUsed?"table-danger":"table-success"}`,children:[e.jsx("th",{scope:"row",children:a+1}),e.jsx("td",{children:e.jsxs("span",{children:[" ",s.token," "]})}),e.jsxs("td",{children:[e.jsx("span",{children:s.value})," $"]}),e.jsx("td",{children:e.jsx("span",{children:f(new Date(s.createdDate),"MMM d, y h:m a")})})]},a+1)):e.jsx("tr",{className:"text-center mt-3  position-absolute start-50",children:t})})]})})]}),e.jsxs("div",{className:"tab-pane fade",id:"paid-tab-pane",role:"tabpanel","aria-labelledby":"paid-tab",tabIndex:0,children:[e.jsxs("h6",{className:"my-fw-bold ",children:["Total Price : ",U||0]}),e.jsx("div",{className:"table-responsive show-history-piont rounded-3 ",children:e.jsxs("table",{className:"table  text-center fw-bold",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:"#"}),e.jsx("th",{scope:"col",children:"Token"}),e.jsx("th",{scope:"col",children:"Price"}),e.jsx("th",{scope:"col",children:"Paid By"}),e.jsx("th",{scope:"col",children:"Date"})]})}),e.jsx("tbody",{children:t!="You dont have any tokens"?l==null?void 0:l.slice().reverse().map((s,a=0)=>e.jsxs("tr",{className:`${s.isUsed?"table-danger":"table-success"}`,children:[e.jsx("th",{scope:"row",children:a+1}),e.jsx("td",{children:e.jsxs("span",{children:[" ",s.token," "]})}),e.jsxs("td",{children:[e.jsx("span",{children:s.value})," $"]}),e.jsx("td",{children:e.jsx("span",{children:s.paidby})}),e.jsx("td",{children:e.jsx("span",{children:f(new Date(s.createdDate),"MMM d, y h:m a")})})]},a+1)):e.jsx("tr",{className:"text-center mt-3  position-absolute start-50",children:t})})]})})]})]})]})]})})})}export{B as default};
