import{r as g,S as M,i as y,d as I,j as e,c as D,B as A,f as w,g as b,h as C,e as S,q as p}from"./index-rN5JyR99.js";import{P as F,a as L}from"./PopJoinCode-RvBogAhi.js";import{C as $}from"./CirclePlus-CELPHVgP.js";import{B as v,D as P,a as U,b as k}from"./Typography-YVUBnHeO.js";import{D as O}from"./DialogTitle-BbVweCPi.js";import"./DialogContentText-tu1HCV76.js";function q({refetchAllTrainng:x,nameRoom:t}){const{setNewMeeting:u}=g.useContext(M),[j,o]=g.useState(!1),c=JSON.parse(localStorage.getItem("dataAuth")),f=`https://livezoon.com/join?room=${t}&roomPassword=false&name=${c.name}&username=admin&audio=true&video=false&screen=false&notify=false&admin=1&&origin=ncomes.network&priamry_color=223f4a`,i=s=>w.get(`${b}/Admin/GetInstructorCourses?InstructorId=${s}`),{data:d,error:n,isLoading:N}=y("getInstructorCourses",()=>i(c.customerAttributeId),{refetchOnWindowFocus:!1,refetchOnMount:!1,refetchInterval:!1});console.log(d,n);const m=s=>{w.post(`${b}/User/CreateLiveCourseMeeting`,s).then(({data:r})=>{console.log(r),u(r),C.success("Create meeting success!"),l(),x()}).catch(r=>{C.error("You have problem!"),console.log(r)})},h=()=>{o(!0)},l=()=>{o(!1)},a=I({initialValues:{courseId:0,instructorId:c.customerAttributeId,lectureLiveName:"",date:"",time:"",url:""},onSubmit:()=>{a.values.date=a.values.date+"T"+a.values.time,delete a.values.time,a.values.url=f,console.log(a.values),m(a.values)}});return e.jsxs(D.Fragment,{children:[e.jsxs(v,{variant:"outlined",className:"my-btn mt-2 bg-main-color-3 text-capitalize fw-bold border-0",onClick:h,children:[e.jsx($,{style:{fontSize:"1.1rem",marginRight:"5px"}})," New Meeting"]}),e.jsxs(P,{open:j,onClose:l,children:[e.jsx(O,{className:"bg-main-color text-white",children:"Create Meeting"}),e.jsx(U,{className:"bg-main-color",style:{width:"clamp(340px,50vw,500px)"},children:e.jsxs("form",{onChange:a.handleChange,onSubmit:a.handleSubmit,className:"",children:[e.jsx("div",{className:"row mt-4",children:e.jsx("div",{className:"col-12",children:e.jsx("input",{required:!0,onChange:a.handleChange,type:"text",className:"form-control",placeholder:"Lecture Name",name:"lectureLiveName"})})}),e.jsx("div",{className:"row mt-4",children:e.jsx("div",{className:"col-12",children:e.jsx("select",{onChange:a.handleChange,className:"form-select bg-main-color text-white",name:"courseId",required:!0,children:d?e.jsxs("div",{className:"",children:[e.jsx("option",{defaultValue:!0,children:"Select Course ID"}),d.data.map(s=>e.jsx("option",{value:s.id,children:s.nameEn}))]}):N?e.jsx(A,{}):e.jsx("option",{className:"text-danger bg-danger",children:n==null?void 0:n.response.data})})})}),e.jsx("div",{className:"row mt-4",children:e.jsx("div",{className:"col-12",children:e.jsx("input",{required:!0,onChange:a.handleChange,type:"date",className:"form-control",placeholder:"Date",name:"date"})})}),e.jsx("div",{className:"row mt-4",children:e.jsx("div",{className:"col-12",children:e.jsx("input",{required:!0,onChange:a.handleChange,type:"time",className:"form-control",name:"time"})})}),e.jsxs(k,{className:"bg-main-color mt-4 pt-3 border-top",children:[e.jsx(v,{className:"text-white",onClick:l,children:"Cancel"}),e.jsx(v,{className:"text-white",type:"submit",children:"Create"})]})]})})]})]})}function B({refetchAllTrainng:x,nameRoom:t}){return e.jsx(e.Fragment,{children:e.jsx("div",{className:"create-meeting ",children:e.jsx(q,{refetchAllTrainng:x,nameRoom:t})})})}function V(){var a;const{newMeeting:t}=g.useContext(M),[u,j]=g.useState(""),o=JSON.parse(localStorage.getItem("dataAuth")),c={height:"80vh",width:"100%",border:"0px"},f=s=>w.get(`${b}/User/GetAllLiveCourseMeetingsForCustomer?customerAttribueId=${s}`),{data:i,isLoading:d,error:n,refetch:N}=y("getAllLiveCourseMeetingsForCustomer",()=>f(o.customerAttributeId),{refetchOnWindowFocus:!1,refetchInterval:!1}),m=i==null?void 0:i.data.filter(s=>new Date(s.trainingDate)-new Date>=-144e5),h=s=>{j(s),console.log(s)},l=s=>`https://livezoon.com/join?room=${s}&roomPassword=false&name=${o.name}&roomPassword=false&audio=false&video=false&screen=false&notify=false`;return d?e.jsx(S,{}):e.jsx(e.Fragment,{children:e.jsx("section",{className:"dash-Meetings mt-5 position-relative",children:e.jsxs("div",{className:"",children:[e.jsxs("div",{className:"row gy-5",children:[e.jsx("div",{className:"col-md-5",children:e.jsxs("div",{className:"row gy-4 pt-1",children:[e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"upcoming-meeting py-4 px-3 bg-body rounded-3 shadow-light h-100",children:[e.jsx("h4",{className:"fw-bold text-center mb-5",children:"Upcoming Meetings"}),n?e.jsx("h3",{className:"text-center fw-bold",children:(a=n==null?void 0:n.response)==null?void 0:a.data}):e.jsxs("div",{className:"",children:[m==null?void 0:m.map((s,r)=>r<4?e.jsxs("div",{className:"time-meeting d-flex fw-bold",children:[e.jsxs("button",{onClick:()=>h(()=>l(5555)),className:"btn flex-grow-1 d-flex gap-3",children:[e.jsx("div",{className:"icon-time",children:e.jsx("i",{className:"fa-solid fa-square text-success"})}),e.jsx("div",{className:"name-meeting",children:e.jsx("p",{className:"fs-6 fw-bold ",children:s.trainingName})})]}),e.jsx("div",{className:"time",children:e.jsx("p",{className:"fs-6 ",children:s.trainingDate?p(new Date(s.trainingDate),"MMM /d - h : mm a"):""})})]},s.trainingId):""),e.jsx(F,{data:i==null?void 0:i.data,join:h})]})]})}),e.jsx("div",{className:"col-12 mt-4",children:e.jsxs("div",{className:"w-100 py-4 px-3 bg-body rounded-3 shadow-light",children:[e.jsx("h6",{className:"fw-bold",children:"Create or Join a Meeting"}),e.jsxs("div",{className:"row align-items-center gy-2",children:[e.jsx("div",{className:"col-lg-5 pb-1",children:e.jsx(B,{refetchAllTrainng:N,nameRoom:5555})}),e.jsx("div",{className:"col-lg-7 ps-lg-0",children:e.jsx(L,{join:()=>h(()=>l(5555))})})]})]})})]})}),e.jsx("div",{className:"col-md-7",children:e.jsx("div",{className:"now-meeting rounded-4 overflow-hidden shadow",children:u?e.jsx("iframe",{allow:"camera; microphone; display-capture; fullscreen; clipboard-read; clipboard-write; autoplay",src:u,style:c,className:"w-100 object-fit-fill d-block "}):e.jsx("div",{className:"d-flex align-items-center justify-content-center rounded-4 overflow-hidden shadow border",style:{height:"80vh"},children:e.jsx("h5",{className:"text-center text-white",children:"No Meeting Now"})})})})]}),e.jsx("div",{className:"row mt-5",children:e.jsx("div",{className:"col-12",children:t?e.jsxs("div",{className:"card-meeting py-4 px-4 bg-body rounded-3 shadow-light",children:[e.jsxs("div",{className:"info-meeting d-flex justify-content-between",children:[e.jsx("p",{children:"creation Date"}),e.jsx("span",{className:"fw-bold",children:t.creationDate?p(new Date(t.creationDate),"MMM /d - h:m a"):""})]}),e.jsxs("div",{className:"info-meeting d-flex justify-content-between",children:[e.jsx("p",{children:"Time of Meeting "}),e.jsx("span",{className:"fw-bold",children:t!=null&&t.date?p(new Date(t.date),"MMM /d - h:m a"):""})]}),e.jsxs("div",{className:"info-meeting d-flex justify-content-between",children:[e.jsx("p",{children:"trainning Code "}),e.jsx("span",{className:"fw-bold",children:t.trainningCode})]}),e.jsxs("div",{className:"info-meeting d-flex justify-content-between",children:[e.jsx("p",{children:"trainning Name"}),e.jsx("span",{className:"fw-bold",children:t.trainningName})]})]}):e.jsx("div",{className:"card-meeting py-4 px-4 bg-body rounded-3 shadow-light h-100",children:e.jsx("h3",{children:"No Meeting Create!"})})})})]})})})}export{V as default};
