import{r as t,S as D,d as k,j as e,c as B,B as I,f as A,g as U,h as y,u as L,i as P,e as M,q as S}from"./index-rN5JyR99.js";import{C as $}from"./CirclePlus-CELPHVgP.js";import{B as w,D as E,a as q,b as z}from"./Typography-YVUBnHeO.js";import{D as J}from"./DialogTitle-BbVweCPi.js";import{S as O,P as R,a as G}from"./PopJoinCode-RvBogAhi.js";import"./DialogContentText-tu1HCV76.js";function Q({refetchAllTrainng:s}){const{setNewMeeting:d}=t.useContext(D),[j,l]=t.useState(!1),p=JSON.parse(localStorage.getItem("dataAuth")),[m,r]=t.useState(!1),g=o=>`https://livezoon.com/join?room=${o}&roomPassword=false&name=admin&username=admin&audio=true&video=false&screen=false&notify=false&admin=1&&origin=ncomes.network&priamry_color=#223f4a`,f=o=>{A.post(`${U}/User/CreateTrainning`,o).then(({data:n})=>{console.log(n),n.url=g(o.trainningName),d(n),y.success("Create meeting success!"),h(),s(),r(!1)}).catch(n=>{y.error("You have problem!"),console.log(n),r(!1)})},x=()=>{l(!0)},h=()=>{l(!1)},a=k({initialValues:{trainningName:"",date:"",time:"",createdBy:p.customerAttributeId},onSubmit:()=>{a.values.date=a.values.date+"T"+a.values.time,delete a.values.time,console.log(a.values),r(!0),f(a.values)}});return e.jsxs(B.Fragment,{children:[e.jsxs(w,{variant:"outlined",className:"my-btn mt-2 bg-main-color-3 text-capitalize fw-bold border-0 ",onClick:x,children:[e.jsx($,{style:{fontSize:"1.1rem",marginRight:"5px"}})," New Meeting"]}),e.jsxs(E,{open:j,onClose:h,children:[e.jsx(J,{className:"bg-main-color ",children:"Create Meeting"}),e.jsx(q,{className:"bg-main-color",style:{width:"clamp(340px,50vw,500px)"},children:e.jsxs("form",{onChange:a.handleChange,onSubmit:a.handleSubmit,className:"",children:[e.jsx("div",{className:"row mt-4",children:e.jsx("div",{className:"col-12",children:e.jsx("input",{required:!0,onChange:a.handleChange,type:"text",className:"form-control",placeholder:"Trainging Name",name:"trainningName"})})}),e.jsx("div",{className:"row mt-4",children:e.jsx("div",{className:"col-12",children:e.jsx("input",{required:!0,onChange:a.handleChange,type:"date",className:"form-control",placeholder:"Date",name:"date"})})}),e.jsx("div",{className:"row mt-4",children:e.jsx("div",{className:"col-12",children:e.jsx("input",{required:!0,onChange:a.handleChange,type:"time",className:"form-control",name:"time"})})}),e.jsxs(z,{className:"bg-main-color mt-4 pt-3 border-top",children:[e.jsx(w,{className:"",onClick:h,children:"Cancel"}),e.jsx(w,{disabled:m,className:"",type:"submit",children:m?e.jsx(I,{}):"Create"})]})]})})]})]})}function V({refetchAllTrainng:s}){return e.jsx(e.Fragment,{children:e.jsx("div",{className:"create-meeting ",children:e.jsx(Q,{refetchAllTrainng:s})})})}function Z(){var v;const{newMeeting:s}=t.useContext(D),[d,j]=t.useState(""),l=JSON.parse(localStorage.getItem("dataAuth")),[p,m]=t.useState(!1),[r,g]=t.useState(""),[f,x]=t.useState(!1),h=L(),a={height:"100vh",width:"100%",border:"0px"},o=()=>{r===""?(g("position-absolute top-0 start-0 w-100 vh-100 z-3"),x(!0)):(g(""),x(!1))},n=i=>A.get(`${U}/User/GetAllTrainningsForCustomer?customerAttribueId=${i}`),{data:c,isLoading:T,error:u,refetch:F}=P("getAllTrainningsForCustomer",()=>n(l.customerAttributeId),{refetchInterval:!1}),N=c==null?void 0:c.data.filter(i=>new Date(i.trainingDate)-new Date>=-144e5),b=i=>{m(!0),j(i),m(!1)};return t.useEffect(()=>{l.allowToCreateMeeting||h("/dashboard-user")},[]),T?e.jsx(M,{}):e.jsx(e.Fragment,{children:e.jsx("section",{className:"dash-Meetings mt-5 position-relative ",children:e.jsxs("div",{className:"",children:[e.jsxs("div",{className:"row position-relative",children:[e.jsx("div",{className:"col-md-5",children:e.jsxs("div",{className:"row gy-4 pt-1",children:[e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"upcoming-meeting py-4 px-3 bg-grdient rounded-3 shadow-light h-100",children:[e.jsx("h4",{className:"fw-bold text-center mb-5",children:"Upcoming Meetings"}),u?e.jsx("h3",{className:"text-center fw-bold",children:(v=u==null?void 0:u.response)==null?void 0:v.data}):N==null?void 0:N.map((i,C)=>C<4?e.jsx(O,{dataUser:l,trainging:i,joinMeeting:b},C):""),e.jsx(R,{data:c==null?void 0:c.data,join:b})]})}),e.jsx("div",{className:"col-12 mt-4 ",children:e.jsxs("div",{className:"w-100 py-4 px-3 bg-body rounded-3 shadow-light ",children:[e.jsx("h6",{className:"fw-bold",children:"Create or Join a Meeting"}),e.jsxs("div",{className:"row align-items-center gy-3",children:[e.jsx("div",{className:"col-md-5 pb-1",children:e.jsx(V,{refetchAllTrainng:F})}),e.jsx("div",{className:"col-md-7 ps-md-0",children:e.jsx(G,{join:b})})]})]})})]})}),e.jsx("div",{className:`col-md-7 ${r}`,children:e.jsxs("div",{className:"now-meeting rounded-4 overflow-hidden shadow position-relative ",children:[e.jsx("button",{disabled:!d,onClick:o,className:"btn border-0 p-0 toggle-screen text-white d-block ms-auto",children:e.jsx("i",{className:`fa-solid fa-${f?"compress":"expand"} fa-2x`})}),d?e.jsx("iframe",{allow:"camera; microphone; display-capture; fullscreen; clipboard-read; clipboard-write; autoplay",src:d,style:a,className:"w-100 object-fit-fill d-block "}):p?e.jsx(M,{}):e.jsx("div",{className:"d-flex align-items-center justify-content-center rounded-4 overflow-hidden shadow border",style:{height:"80vh"},children:e.jsx("h5",{className:"text-center",children:"No Meeting Now"})})]})})]}),e.jsx("div",{className:"row mt-5",children:e.jsx("div",{className:"col-12",children:s?e.jsxs("div",{className:"card-meeting py-4 px-4 bg-body rounded-3 shadow-light ",children:[e.jsxs("div",{className:"info-meeting d-flex justify-content-between",children:[e.jsx("p",{children:"creation Date"}),e.jsx("span",{className:"fw-bold",children:s.creationDate?S(new Date(s.creationDate),"MMM /d - h:m a"):""})]}),e.jsxs("div",{className:"info-meeting d-flex justify-content-between",children:[e.jsx("p",{children:"Time of Meeting "}),e.jsx("span",{className:"fw-bold",children:s!=null&&s.date?S(new Date(s.date),"MMM /d - h:m a"):""})]}),e.jsxs("div",{className:"info-meeting d-flex justify-content-between",children:[e.jsx("p",{children:"trainning Code "}),e.jsx("span",{className:"fw-bold",children:s.trainningCode})]}),e.jsxs("div",{className:"info-meeting d-flex justify-content-between",children:[e.jsx("p",{children:"trainning Name"}),e.jsx("span",{className:"fw-bold",children:s.trainningName})]}),e.jsxs("div",{className:"info-meeting d-flex justify-content-between border",children:[e.jsx("p",{children:"trainning Url"}),e.jsx("span",{className:"fw-bold w-50",children:s.url})]})]}):e.jsx("div",{className:"card-meeting py-4 px-4 bg-body rounded-3 shadow-light h-100 ",children:e.jsx("h3",{children:"No Meeting Create!"})})})})]})})})}export{Z as default};
